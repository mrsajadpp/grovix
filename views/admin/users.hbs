{{> headers/users}}

<div class="container" style="margin-top: 90px;">
  <table class="user-table">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Contact No</th>
        <th>Admin</th>
        <th>Verified</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {{#each user_list}}
      <tr>
        <td>{{this.first_name}}</td>
        <td>{{this.last_name}}</td>
        <td>{{this.email}}</td>
        <td>{{this.contact_no}}</td>
        <td>{{#if this.admin}}Yes{{else}}No{{/if}}</td>
        <td>{{#if this.verified}}Yes{{else}}No{{/if}}</td>
        <td>{{#if this.status}}Active{{else}}Blocked{{/if}}</td>
        <td>
          <form action="/admin/users/block/{{this._id}}" method="POST" class="block-form" style="display:inline;">
            <button type="button" onclick="confirmBlock(this.form, '{{this.first_name}}')">{{#if this.status}}Block{{else}}Unblock{{/if}}</button>
          </form>
          <form action="/admin/users/ban/{{this._id}}" method="POST" class="ban-form" style="display:inline;">
            <button type="button" onclick="confirmBan(this.form, '{{this.first_name}}')">Ban</button>
          </form>
        </td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>

<script>
  function confirmBlock(form, userName) {
    const confirmation = prompt(`Type 'BLOCK THIS USER' to block ${userName}`);
    if (confirmation === 'BLOCK THIS USER') {
      form.submit();
    } else {
      alert('User blocking cancelled.');
    }
  }

  function confirmBan(form, userName) {
    const confirmation = prompt(`Type 'BAN THIS USER' to ban ${userName}`);
    if (confirmation === 'BAN THIS USER') {
      form.submit();
    } else {
      alert('User banning cancelled.');
    }
  }
</script>

<style>
  .container {
    width: 90%;
    margin: auto;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 10px;
  }
  .user-table {
    width: 100%;
    border-collapse: collapse;
  }
  .user-table th, .user-table td {
    border: 1px solid #ddd;
    padding: 8px;
  }
  .user-table th {
    background-color: #f2f2f2;
  }
</style>
